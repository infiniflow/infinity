/home/yzq/GitHub/infinity/cmake-build-release/src/test_main --gtest_filter=AnnIVFFlatL2Benchmark.*:AnnIVFFlatL2Benchmark/*.*:AnnIVFFlatL2Benchmark.*/*:*/AnnIVFFlatL2Benchmark.*/*:*/AnnIVFFlatL2Benchmark/*.* --gtest_color=no
Testing started at 3:41 PM ...
max omp threads: 1
max omp threads: 1
[0.000 s] Loading train set
[0.028 s] Training on 100000 vectors
, with 316 centroids
perm:
69775 70546 90246 94746 1524 32024 91830 97549 38599 81250 93433 52022 47466 42446 96993 23397 35740 22739 79346 2992 

Iteration 0 (0.214988 s, search 0.212457 s): objective=7.0652e+09
imbalance=1.6954979233 nsplit=0

Iteration 1 (0.4266918945 s, search 0.4211821289 s): objective=4825324032.0000000000
imbalance=1.2971970763 nsplit=0

Iteration 2 (0.6365170898 s, search 0.6280490723 s): objective=4684203520.0000000000
imbalance=1.1972782763 nsplit=0

Iteration 3 (0.8468059082 s, search 0.8355219727 s): objective=4629955584.0000000000
imbalance=1.1578570982 nsplit=0

Iteration 4 (1.0569479980 s, search 1.0432541504 s): objective=4601291264.0000000000
imbalance=1.1379240978 nsplit=0

Iteration 5 (1.2661450195 s, search 1.2497792969 s): objective=4582863360.0000000000
imbalance=1.1264150112 nsplit=0

Iteration 6 (1.4763220215 s, search 1.4569414062 s): objective=4570034176.0000000000
imbalance=1.1174052758 nsplit=0

Iteration 7 (1.6862539062 s, search 1.6639274902 s): objective=4560621568.0000000000
imbalance=1.1108396506 nsplit=0

Iteration 8 (1.8967080078 s, search 1.8717954102 s): objective=4553321984.0000000000
imbalance=1.1055455268 nsplit=0

Iteration 9 (2.1068808594 s, search 2.0788784180 s): objective=4547488256.0000000000
imbalance=1.1014199559 nsplit=0
[2.164 s] Loading database
[2.395 s] Indexing database, size 1000000*128
#####################################################
faiss coarse_idx of 567736:
88
#####################################################


i: 567736, assigned centroid: 88

88 contain 567736: 1
#####################################################
faiss nearest_centroids of 567736 (float):
88 25479.4824218750
207 33852.3164062500
#####################################################

[5.252 s] Loading queries
[5.253 s] Loading ground truth for 10000 queries
[5.257 s] Perform a search on 10000 queries

i: 1472, selected_centroid: 116

116 contain 567736: 0

286 contain 567736: 0
############################
[6.389 s] Compute recalls
############################
############################
n_1: 5257
n_10: 47351
n_100: 400091
############################
R@1 = 0.5257
R@10 = 0.4735
R@100 = 0.4001
##########################################################
Hello ?
##########################################################
[0.000 s] Loading train set
[0.011 s] Loading database
[0.142 s] Training and Indexing on 100000 vectors
, with 316 centroids

[0.000 s] k-means training begin.
warning : too many vectors, more than max_points_per_centroid (256) * partition_num (316) = 80896 vectors to train
warning : will randomly choose max_points_per_centroid (256) * partition_num (316) = 80896 vectors to train

[0.011 s] training data prepared.
[0.011 s] time for preparing training data: 0.011 s

[0.011 s] centroids initialized.
[0.011 s] time for initializing centroids: 0.000 s

[0.011 s] iteration begin: 1

[0.089 s] training data partitioned.
[0.089 s] time for partitioning training data: 0.078 s

[0.089 s] sum of partition_element_count: 80896

[0.091 s] centroids updated.
[0.091 s] time for updating centroids: 0.002 s
[0.091 s] 
imbalance factor: 1.8678215123
[0.091 s] Iteration 1 (0.08 s, search 0.08 s): objective=7011309056.00
imbalance=1.8678215 nsplit=0

[0.091 s] iteration begin: 2

[0.167 s] training data partitioned.
[0.167 s] time for partitioning training data: 0.076 s

[0.167 s] sum of partition_element_count: 80896

[0.170 s] centroids updated.
[0.170 s] time for updating centroids: 0.002 s
[0.170 s] 
imbalance factor: 1.3367409042
[0.170 s] Iteration 2 (0.08 s, search 0.08 s): objective=4829604864.00
imbalance=1.3367409 nsplit=0

[0.170 s] iteration begin: 3

[0.247 s] training data partitioned.
[0.247 s] time for partitioning training data: 0.077 s

[0.247 s] sum of partition_element_count: 80896

[0.249 s] centroids updated.
[0.249 s] time for updating centroids: 0.002 s
[0.249 s] 
imbalance factor: 1.2148549527
[0.249 s] Iteration 3 (0.08 s, search 0.08 s): objective=4679162368.00
imbalance=1.2148550 nsplit=0

[0.249 s] iteration begin: 4

[0.326 s] training data partitioned.
[0.326 s] time for partitioning training data: 0.077 s

[0.326 s] sum of partition_element_count: 80896

[0.328 s] centroids updated.
[0.328 s] time for updating centroids: 0.002 s
[0.328 s] 
imbalance factor: 1.1684275760
[0.328 s] Iteration 4 (0.08 s, search 0.08 s): objective=4622029312.00
imbalance=1.1684276 nsplit=0

[0.328 s] iteration begin: 5

[0.405 s] training data partitioned.
[0.405 s] time for partitioning training data: 0.077 s

[0.405 s] sum of partition_element_count: 80896

[0.407 s] centroids updated.
[0.407 s] time for updating centroids: 0.002 s
[0.407 s] 
imbalance factor: 1.1453454706
[0.407 s] Iteration 5 (0.08 s, search 0.08 s): objective=4593634816.00
imbalance=1.1453455 nsplit=0

[0.407 s] iteration begin: 6

[0.484 s] training data partitioned.
[0.484 s] time for partitioning training data: 0.077 s

[0.484 s] sum of partition_element_count: 80896

[0.487 s] centroids updated.
[0.487 s] time for updating centroids: 0.002 s
[0.487 s] 
imbalance factor: 1.1310822692
[0.487 s] Iteration 6 (0.08 s, search 0.08 s): objective=4576282112.00
imbalance=1.1310823 nsplit=0

[0.487 s] iteration begin: 7

[0.563 s] training data partitioned.
[0.563 s] time for partitioning training data: 0.076 s

[0.563 s] sum of partition_element_count: 80896

[0.565 s] centroids updated.
[0.565 s] time for updating centroids: 0.002 s
[0.565 s] 
imbalance factor: 1.1221250703
[0.565 s] Iteration 7 (0.08 s, search 0.08 s): objective=4564602880.00
imbalance=1.1221251 nsplit=0

[0.565 s] iteration begin: 8

[0.641 s] training data partitioned.
[0.641 s] time for partitioning training data: 0.076 s

[0.641 s] sum of partition_element_count: 80896

[0.643 s] centroids updated.
[0.643 s] time for updating centroids: 0.002 s
[0.643 s] 
imbalance factor: 1.1160310190
[0.643 s] Iteration 8 (0.08 s, search 0.08 s): objective=4556201472.00
imbalance=1.1160310 nsplit=0

[0.643 s] iteration begin: 9

[0.720 s] training data partitioned.
[0.720 s] time for partitioning training data: 0.076 s

[0.720 s] sum of partition_element_count: 80896

[0.722 s] centroids updated.
[0.722 s] time for updating centroids: 0.002 s
[0.722 s] 
imbalance factor: 1.1107662539
[0.722 s] Iteration 9 (0.08 s, search 0.08 s): objective=4549773824.00
imbalance=1.1107663 nsplit=0

[0.722 s] iteration begin: 10

[0.798 s] training data partitioned.
[0.798 s] time for partitioning training data: 0.076 s

[0.798 s] sum of partition_element_count: 80896

[0.800 s] centroids updated.
[0.800 s] time for updating centroids: 0.002 s
[0.800 s] 
imbalance factor: 1.1074981689
[0.800 s] Iteration 10 (0.08 s, search 0.08 s): objective=4544686080.00
imbalance=1.1074982 nsplit=0

##################################################
[0.000 s] input vectors classification begin.
##################################################

##################################################
[0.941 s] input vectors classification finished.
##################################################

##################################################
[1.056 s] input vectors insertion finished.
##################################################

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
88 contain 567736: 0

286 contain 567736: 0
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[1.998 s] Loading queries
[1.999 s] Loading ground truth for 10000 queries
[2.001 s] Perform a search on 10000 queries
############################
############################
[6.166 s] Compute recalls
############################
############################
n_1: 5344
n_10: 47895
n_100: 404860
############################
R@1 = 0.5344
R@10 = 0.4789
R@100 = 0.4049

######################################

############################
D1 and D2 difference:
D1[0 : 0]: 55091.000 D2[0 : 0]: 54229.000	difference: 862.000
D1[0 : 1]: 59531.000 D2[0 : 1]: 55091.000	difference: 4440.000
D1[0 : 2]: 65260.000 D2[0 : 2]: 67010.000	difference: -1750.000
D1[0 : 3]: 65697.000 D2[0 : 3]: 71441.000	difference: -5744.000
D1[0 : 4]: 69844.000 D2[0 : 4]: 73581.000	difference: -3737.000
D1[0 : 5]: 71861.000 D2[0 : 5]: 74016.000	difference: -2155.000
D1[0 : 6]: 73344.000 D2[0 : 6]: 75634.000	difference: -2290.000
D1[0 : 7]: 73537.000 D2[0 : 7]: 75944.000	difference: -2407.000
D1[0 : 8]: 73793.000 D2[0 : 8]: 77587.000	difference: -3794.000
D1[0 : 9]: 74016.000 D2[0 : 9]: 78092.000	difference: -4076.000
############################
I1 and I2 difference:
I1[0 : 0]: 934876 I2[0 : 0]: 932085
I1[0 : 1]: 561813 I2[0 : 1]: 934876
I1[0 : 2]: 708177 I2[0 : 2]: 695756
I1[0 : 3]: 706771 I2[0 : 3]: 455537
I1[0 : 4]: 701258 I2[0 : 4]: 908244
I1[0 : 5]: 872728 I2[0 : 5]: 893601
I1[0 : 6]: 36538 I2[0 : 6]: 565419
I1[0 : 7]: 562594 I2[0 : 7]: 568573
I1[0 : 8]: 600499 I2[0 : 8]: 722642
I1[0 : 9]: 893601 I2[0 : 9]: 779712
############################
############################
D1 and D2 difference:
D1[5002 : 2]: 67231.000 D2[5002 : 2]: 66443.000	difference: 788.000
D1[5002 : 3]: 68367.000 D2[5002 : 3]: 67231.000	difference: 1136.000
D1[5002 : 4]: 70044.000 D2[5002 : 4]: 69152.000	difference: 892.000
D1[5002 : 5]: 71925.000 D2[5002 : 5]: 70044.000	difference: 1881.000
D1[5002 : 6]: 73031.000 D2[5002 : 6]: 70877.000	difference: 2154.000
D1[5002 : 7]: 74330.000 D2[5002 : 7]: 71759.000	difference: 2571.000
D1[5002 : 8]: 77664.000 D2[5002 : 8]: 72042.000	difference: 5622.000
D1[5002 : 9]: 77813.000 D2[5002 : 9]: 73031.000	difference: 4782.000
D1[5002 : 10]: 79473.000 D2[5002 : 10]: 74040.000	difference: 5433.000
D1[5002 : 11]: 79662.000 D2[5002 : 11]: 74290.000	difference: 5372.000
############################
I1 and I2 difference:
I1[5002 : 2]: 859371 I2[5002 : 2]: 13423
I1[5002 : 3]: 310129 I2[5002 : 3]: 859371
I1[5002 : 4]: 800927 I2[5002 : 4]: 796125
I1[5002 : 5]: 937866 I2[5002 : 5]: 800927
I1[5002 : 6]: 762672 I2[5002 : 6]: 109003
I1[5002 : 7]: 311223 I2[5002 : 7]: 709273
I1[5002 : 8]: 434328 I2[5002 : 8]: 735994
I1[5002 : 9]: 573714 I2[5002 : 9]: 762672
I1[5002 : 10]: 541982 I2[5002 : 10]: 553663
I1[5002 : 11]: 728844 I2[5002 : 11]: 689723
############################
Process finished with exit code 0

