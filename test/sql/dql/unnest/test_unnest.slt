statement ok
DROP TABLE IF EXISTS test_unnest;

statement ok
CREATE TABLE test_unnest (c1 INT, c2 ARRAY(INT));

statement ok
INSERT INTO test_unnest VALUES
(1, {0, 1}),
(2, {2, 3}),
(3, {0, 1, 2}),
(4, {0, 2, 3});


query I rowsort
SELECT unnest(c2) FROM test_unnest;
----
0
0
0
1
1
2
2
2
3
3

query II rowsort
SELECT c1, unnest(c2) FROM test_unnest;
----
1 0
1 1
2 2
2 3
3 0
3 1
3 2
4 0
4 2
4 3

query II rowsort
SELECT c1, unnest(c2) as uc2 FROM test_unnest where uc2 > 1;
----
2 2
2 3
3 2
4 2
4 3

statement ok
DROP TABLE test_unnest;
