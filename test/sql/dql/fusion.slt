# name: test/sql/dql/fusion.slt
# description: Test fulltext + knn + fusion search
# group: [dql]
# refers to: fulltext.slt, test_knn_ip.slt

statement ok
DROP TABLE IF EXISTS enwiki_embedding;

statement ok
CREATE TABLE enwiki_embedding(doctitle varchar, docdate varchar, body varchar, num INT, vec EMBEDDING(FLOAT, 4));

# copy data from csv file
query I
COPY enwiki_embedding FROM '/tmp/infinity/test_data/enwiki_embedding_9999.csv' WITH ( DELIMITER '\t' );
----

statement ok
CREATE INDEX ft_index ON enwiki_embedding(body) USING FULLTEXT WITH(ANALYZER=segmentation) (doctitle, docdate) USING FULLTEXT;

query TTT
SELECT doctitle, docdate, body, num, vec FROM enwiki_embedding SEARCH MATCH('doctitle^2,body^5', 'harmful chemical', 'topn=3'), KNN(vec, [0.3, 0.3, 0.2, 0.2], 'float', 'ip', 3), FUSION('rrf');
----
Avicenna 29-APR-2012 07:47:29.000 [[saliva]]tion, [[Somnolence|sleepiness]] | [[insomnia]], [[wakefulness]] |- | Physical signs | high [[pulse]] rate, lassitude | [[flaccid]] joints | [[diarrhea]], [[eye puffiness|swollen eyelids]], rough skin, acquired [[habit (psychology)|habit]] | rough skin, acquired habit |- | Foods & medicines | [http://www.thefreedictionary.com/calefacient calefacients] harmful, [http://www.thefreedictionary.com/Infrigidate infrigidants] beneficial | [http://www.thefreedictionary.com/Infrigidate infrigidants] harmful, [http://www.thefreedictionary.com/calefacient calefacients] beneficial | [[moisture|moist]] articles harmful | [[wikt:dry|dry]] regimen harmful, [[humectant]]s beneficial |- | Relation to weather | worse in summer | worse in winter | | bad in autumn |}  ===Physical Exercise: the Key to Health=== {{Refimprove section|please provide publication information|date=June 2010}} '''The Canon of Medicine: Volume 1 of 5; Part 4 of 5: The Preservation of Health '''  Of Ibn Sina's Canon of Medicine which is written 2 0.2,0.1,0.3,0.4
Anarchism 30-APR-2012 03:25:17.000 Tucker|(Benjamin) Tucker]] referred to himself many times as a socialist and considered his philosophy to be "Anarchistic socialism." "''[[An Anarchist FAQ]]''by Various Authors</ref><ref>"Because revolution is the fire of our will and a need of our solitary minds; it is an obligation of the libertarian aristocracy. To create new ethical values. To create new aesthetic values. To communalize material wealth. To individualize spiritual wealth." [http://www.theanarchistlibrary.org/HTML/Renzo_Novatore__Toward_the_Creative_Nothing.html [[Renzo Novatore]]. ''Toward the Creative Nothing'']</ref> while some anarcho-communists are also individualists.<ref name="bobblack">[[Post-left anarchy|Post-left]] anarcho-communist [[Bob Black]] after analysing [[Insurrectionary anarchism|insurrectionary]] anarcho-communist [[Luigi Galleani]]'s view on anarcho-communism went as far as saying that "communism is the final fulfillment of [[individualism]].... The apparent contradiction between individualism and communism rests on 4 0.4,0.3,0.2,0.1
Alkali metal 30-APR-2012 05:35:44.000 royale des Sciences| title = Sur la Base de Sel Marine| last = du Monceau|first = H. L. D.| pages = 65–68| language = French}}</ref> The exact chemical composition of potassium and sodium compounds, and the status as chemical element of potassium and sodium, was not known then, and thus [[Antoine Lavoisier]] did include the alkali in his list of chemical elements in 1789.<ref name="weeks">{{cite journal|doi = 10.1021/ed009p1035|title = The discovery of the elements. IX. Three alkali metals: Potassium, sodium, and lithium|year = 1932|last1 = Weeks|first1 = Mary Elvira|journal = Journal of Chemical Education|volume = 9|issue = 6|pages = 1035|bibcode = 1932JChEd...9.1035W}}</ref><ref name="disco">{{cite journal|jstor = 228541|pages = 247–258|last1 = Siegfried|first1 = R.|title = The Discovery of Potassium and Sodium, and the Problem of the Chemical Elements|volume = 54|issue = 2|journal = Isis|year = 1963|doi = 10.1086/349704}}</ref> Pure potassium was first isolated in 1807 in England by Sir [[Humphry 2 0.2,0.1,0.3,0.4
Anarchism 30-APR-2012 03:25:17.000 developed on these lines, the voluntary associations which already now begin to cover all the fields of human activity would take a still greater extension so as to substitute themselves for the state in all its functions." [http://www.theanarchistlibrary.org/HTML/Petr_Kropotkin___Anarchism__from_the_Encyclopaedia_Britannica.html [[Peter Kropotkin]]. “Anarchism” from the Encyclopædia Britannica]</ref>  There are many types and traditions of anarchism, not all of which are mutually exclusive.<ref>{{Cite book|last=Sylvan |first=Richard |chapter=Anarchism |title=A Companion to Contemporary Political Philosophy |editors=Goodwin, Robert E. and Pettit |publisher=Philip. Blackwell Publishing |year=1995 |page=231}}</ref> [[Anarchist schools of thought]] can differ fundamentally, supporting anything from extreme individualism to complete collectivism.<ref name=slevin/> Strains of anarchism have been divided into the categories of [[social anarchism|social]] and [[individualist anarchism]] or similar dual 4 0.4,0.3,0.2,0.1
Atom 20-APR-2012 03:53:14.000 beam of light energy in a narrow frequency band.<ref name=watkins_sjsu/>  ===Valence and bonding behavior=== {{Main|Valence (chemistry)|Chemical bond}}  The outermost electron shell of an atom in its uncombined state is known as the valence shell, and the electrons in that shell are called [[valence electron]]s. The number of valence electrons determines the [[chemical bond|bonding]] behavior with other atoms. Atoms tend to [[Chemical reaction|chemically react]] with each other in a manner that fills (or empties) their outer valence shells.<ref name=reusch20070716/> For example, a transfer of a single electron between atoms is a useful approximation for bonds that form between atoms with one-electron more than a filled shell, and others that are one-electron short of a full shell, such as occurs in the compound [[sodium chloride]] and other chemical ionic salts. However, many elements display multiple valences, or tendencies to share differing numbers of electrons in different compounds. Thus, [[chemical 4 0.4,0.3,0.2,0.1
Anarchism 30-APR-2012 03:25:17.000 Essays]]''.</ref><ref>Individualist anarchist Benjamin Tucker defined anarchism as opposition to authority as follows "They found that they must turn either to the right or to the left, — follow either the path of Authority or the path of Liberty. Marx went one way; Warren and Proudhon the other. Thus were born State Socialism and Anarchism...Authority, takes many shapes, but, broadly speaking, her enemies divide themselves into three classes: first, those who abhor her both as a means and as an end of progress, opposing her openly, avowedly, sincerely, consistently, universally; second, those who profess to believe in her as a means of progress, but who accept her only so far as they think she will subserve their own selfish interests, denying her and her blessings to the rest of the world; third, those who distrust her as a means of progress, believing in her only as an end to be obtained by first trampling upon, violating, and outraging her. These three phases of opposition to Liberty are met in almost 4 0.4,0.3,0.2,0.1

# Clean up
statement ok
DROP TABLE enwiki_embedding;


