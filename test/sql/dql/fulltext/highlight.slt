# name: test/sql/dql/hightlight.slt
# description: Test fulltext+hightlight search
# group: [dql]

statement ok
DROP TABLE IF EXISTS sqllogic_test_enwiki;

statement ok
CREATE TABLE sqllogic_test_enwiki(doctitle varchar DEFAULT '', docdate varchar DEFAULT '', body varchar DEFAULT '');

# copy data from csv file
query I
COPY sqllogic_test_enwiki FROM '/var/infinity/test_data/enwiki_99.csv' WITH ( DELIMITER '\t', FORMAT CSV );
----

statement ok
CREATE INDEX ft_index ON sqllogic_test_enwiki(body) USING FULLTEXT;

statement ok
CREATE INDEX ft_index2 ON sqllogic_test_enwiki(doctitle) USING FULLTEXT;

query IR rowsort
SELECT ROW_ID(), SCORE() FROM sqllogic_test_enwiki SEARCH MATCH TEXT ('doctitle,body^5', 'harmful chemical anarchism', 'topn=3;block_max=compare');
----
0 25.094610
19 3.029415
68 3.029415

query IRTT rowsort
SELECT ROW_ID(), SCORE(), doctitle, body HIGHLIGHT body, doctitle FROM sqllogic_test_enwiki SEARCH MATCH TEXT ('doctitle,body^5', 'harmful chemical anarchism', 'topn=3;block_max=compare');
----
0 25.094610 (empty) {{Redirect|<em>anarch</em>ist|the fictional character|<em>anarch</em>ist (comics)}} {{Redirect|<em>anarch</em>ists}} {{<em>anarch</em>ism sidebar}} {{Libertarianism sidebar}}  '''<em>anarch</em>ism''' is generally defined as the [[political philosophy]] which holds the [[state (polity)|state]] to be undesirable,... and <em>harm</em>ful,<ref name="definition"> {{Cite journal|last=Malatesta|first=Errico|title=Towards <em>anarch</em>ism|journal=MAN!...org/archive/malatesta/1930s/xx/to<em>anarch</em>y....wxl<em>anarch</em>ist14/BNStory/lifeWork/home/ |title=Working for The Man |journal=[[The Globe and Mail]] |accessdate=2008-04-14 |last=Agrell |first=Siri |date=2007-05-14}} {{cite web|url=http://www.
19 3.029415 (empty) ... Facing the Enemy: A History of <em>anarch</em>ist Organization from Proudhon to May 1968.... Cuban <em>anarch</em>ism.... "[[libertarian socialism]]" is sometimes used as a synonym for [[socialist <em>anarch</em>ism]],... |title=Contemporary <em>anarch</em>ism |publisher=Transaction Publishers |year=1979 |page=40|isbn=0-87855-097-6}}</ref><ref>Noam Chomsky,...</ref> to distinguish it from "individualist libertarianism" (individualist <em>anarch</em>ism).... referring to free-market <em>anarch</em>ism as "[[libertarian <em>anarch</em>ism]]".
68 3.029415 (empty)  the Bulgarian <em>anarch</em>ist Communist Federation reemerged as part of a factory and workplace committee movement,...com/<em>anarch</em>ism-a-documentary-history-of-libertarian-ideas-volume-two-the-emergence-of-the-new-<em>anarch</em>ism-1939-1977/ <em>anarch</em>ism: A Documentary History of Libertarian Ideas, Volume Two: The Emergence of the New <em>anarch</em>ism (1939-1977) « Robert Graham’s <em>anarch</em>ism Weblog<!-- Bot generated title -->]</ref> In 1945 in [[<em>anarch</em>ism in France|France]] the [[Fédération <em>anarch</em>iste]] was established and the also [[Synthesist <em>anarch</em>ism|synthesist]] [[Federazione <em>anarch</em>ica Italiana]] was founded in [[<em>anarch</em>ism in Italy|Italy]]. Korean <em>anarch</em>ists formed the League of Free Social Constructors in September 1945<ref name="robertgraham.


# Clean up
statement ok
DROP TABLE sqllogic_test_enwiki;
