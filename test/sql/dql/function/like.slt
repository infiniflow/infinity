statement ok
DROP TABLE IF EXISTS test_like;

statement ok
CREATE TABLE test_like (c1 varchar);

statement ok
INSERT INTO test_like VALUES ('hello world'), ('hello_world'), ('cat'), ('cat%');

query T
SELECT c1 FROM test_like WHERE c1 LIKE 'hello world';
----
hello world

query T
SELECT c1 FROM test_like WHERE c1 LIKE 'hel%wor%';
----
hello world
hello_world

query T
SELECT c1 FROM test_like WHERE c1 NOT LIKE 'hel%wor%';
----
cat
cat%

query T
SELECT c1 FROM test_like WHERE c1 LIKE 'c%' AND c1 LIKE '%t';
----
cat

query T
SELECT c1 FROM test_like WHERE c1 LIKE 'ca_';
----
cat

query T
SELECT c1 FROM test_like WHERE c1 LIKE 'cat%';
----
cat
cat%

query T
SELECT c1 FROM test_like WHERE c1 LIKE 'cat\%';
----
cat%

query T
SELECT c1 FROM test_like WHERE c1 LIKE 'hello\_%' ESCAPE '\';
----
hello_world

query T
SELECT c1 FROM test_like WHERE c1 NOT LIKE 'hello#_%' ESCAPE '#';
----
hello world
cat
cat%

query T
SELECT * FROM test_like WHERE SUBSTRING(c1, 0, 3) LIKE 'hel';
----
hello world
hello_world

statement error
SELECT c1 FROM test_like WHERE c1 LIKE 'test%' ESCAPE c1;

statement error
SELECT c1 FROM test_like WHERE c1 LIKE 'test%' ESCAPE 'ab';

statement ok
DROP TABLE test_like;