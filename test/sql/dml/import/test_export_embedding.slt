statement ok
DROP TABLE IF EXISTS test_export_jsonl;

statement ok
CREATE TABLE test_export_jsonl (name VARCHAR, age INT, array EMBEDDING(FLOAT, 4));

statement ok
INSERT INTO test_export_jsonl VALUES(3, '4433252', [1.1, 2.03, 3.04, 4.0]);

statement ok
INSERT INTO test_export_jsonl VALUES(4, '4433253', [1.9, 2.0, 3.045, 4.5]);

query III
SELECT * FROM test_export_jsonl;
----
3 4433252 1.1,2.03,3.04,4
4 4433253 1.9,2,3.045,4.5

query I
COPY test_export_jsonl TO '/var/infinity/test_data/test_export_jsonl.jsonl' WITH (FORMAT JSONL, DELIMITER ',');
----

query I
COPY test_export_jsonl FROM '/var/infinity/test_data/test_export_jsonl.jsonl' WITH (FORMAT JSONL, DELIMITER ',');
----

query III
SELECT * FROM test_export_jsonl;
----
3 4433252 1.1,2.03,3.04,4
4 4433253 1.9,2,3.045,4.5
3 4433252 1.1,2.03,3.04,4
4 4433253 1.9,2,3.045,4.5

query III
SELECT count(*) FROM test_export_jsonl;
----
4

statement ok
DROP TABLE IF EXISTS test_export_jsonl;